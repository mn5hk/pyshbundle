
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://abhimhamane.github.io/pyshbundle/load_data/">
      
      
        <link rel="prev" href="../pyshbundle/">
      
      
        <link rel="next" href="../convert_data_formats/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>Load Data - pyshbundle</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.35f28582.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#load-data" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="pyshbundle" class="md-header__button md-logo" aria-label="pyshbundle" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pyshbundle
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Load Data
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/abhimhamane/pyshbundle" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="pyshbundle" class="md-nav__button md-logo" aria-label="pyshbundle" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    pyshbundle
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/abhimhamane/pyshbundle" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../theory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Theoretical Background
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/mn5hk/pyshbundle/issues" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Report Issues
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reference Manual
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Reference Manual
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pyshbundle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pyshbundle Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Load Data
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Load Data
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_jpl_file" class="md-nav__link">
    <span class="md-ellipsis">
      parse_jpl_file
    </span>
  </a>
  
    <nav class="md-nav" aria-label="parse_jpl_file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_jpl_file--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_jpl_header" class="md-nav__link">
    <span class="md-ellipsis">
      parse_jpl_header
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_lines" class="md-nav__link">
    <span class="md-ellipsis">
      parse_lines
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_csr_file" class="md-nav__link">
    <span class="md-ellipsis">
      parse_csr_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_csr_header" class="md-nav__link">
    <span class="md-ellipsis">
      parse_csr_header
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_itsg_file" class="md-nav__link">
    <span class="md-ellipsis">
      parse_itsg_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_itsg_header" class="md-nav__link">
    <span class="md-ellipsis">
      parse_itsg_header
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_tn13_header" class="md-nav__link">
    <span class="md-ellipsis">
      parse_tn13_header
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_tn14_header" class="md-nav__link">
    <span class="md-ellipsis">
      parse_tn14_header
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.find_date_in_replacemnt_file" class="md-nav__link">
    <span class="md-ellipsis">
      find_date_in_replacemnt_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_C10_11_replcmnt_coeff" class="md-nav__link">
    <span class="md-ellipsis">
      extract_C10_11_replcmnt_coeff
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_C20_replcmnt_coeff" class="md-nav__link">
    <span class="md-ellipsis">
      extract_C20_replcmnt_coeff
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_C30_replcmnt_coeff" class="md-nav__link">
    <span class="md-ellipsis">
      extract_C30_replcmnt_coeff
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.sub2ind" class="md-nav__link">
    <span class="md-ellipsis">
      sub2ind
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.cklm2sc_new" class="md-nav__link">
    <span class="md-ellipsis">
      cklm2sc_new
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_SH_data" class="md-nav__link">
    <span class="md-ellipsis">
      extract_SH_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="extract_SH_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_SH_data--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_SH_data--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_deg1_coeff_tn13" class="md-nav__link">
    <span class="md-ellipsis">
      extract_deg1_coeff_tn13
    </span>
  </a>
  
    <nav class="md-nav" aria-label="extract_deg1_coeff_tn13">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_deg1_coeff_tn13--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_deg1_coeff_tn13--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_deg2_3_coeff_tn14" class="md-nav__link">
    <span class="md-ellipsis">
      extract_deg2_3_coeff_tn14
    </span>
  </a>
  
    <nav class="md-nav" aria-label="extract_deg2_3_coeff_tn14">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_deg2_3_coeff_tn14--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_deg2_3_coeff_tn14--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.read_GRACE_SH_paths" class="md-nav__link">
    <span class="md-ellipsis">
      read_GRACE_SH_paths
    </span>
  </a>
  
    <nav class="md-nav" aria-label="read_GRACE_SH_paths">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.read_GRACE_SH_paths--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.read_GRACE_SH_paths--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#computing-ling-term-mean" class="md-nav__link">
    <span class="md-ellipsis">
      Computing Ling Term Mean
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.load_longterm_mean" class="md-nav__link">
    <span class="md-ellipsis">
      load_longterm_mean
    </span>
  </a>
  
    <nav class="md-nav" aria-label="load_longterm_mean">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.load_longterm_mean--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.load_longterm_mean--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physical-and-geodetic-constants" class="md-nav__link">
    <span class="md-ellipsis">
      Physical and Geodetic Constants
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.GRACEconstants" class="md-nav__link">
    <span class="md-ellipsis">
      GRACEconstants
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    <span class="md-ellipsis">
      Reference
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../convert_data_formats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Convert Data Formats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core_functionality/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Core Functionality
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../auxillary_codes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Auxillary Codes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../acknowledgement/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acknowledgement
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_jpl_file" class="md-nav__link">
    <span class="md-ellipsis">
      parse_jpl_file
    </span>
  </a>
  
    <nav class="md-nav" aria-label="parse_jpl_file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_jpl_file--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_jpl_header" class="md-nav__link">
    <span class="md-ellipsis">
      parse_jpl_header
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_lines" class="md-nav__link">
    <span class="md-ellipsis">
      parse_lines
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_csr_file" class="md-nav__link">
    <span class="md-ellipsis">
      parse_csr_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_csr_header" class="md-nav__link">
    <span class="md-ellipsis">
      parse_csr_header
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_itsg_file" class="md-nav__link">
    <span class="md-ellipsis">
      parse_itsg_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_itsg_header" class="md-nav__link">
    <span class="md-ellipsis">
      parse_itsg_header
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_tn13_header" class="md-nav__link">
    <span class="md-ellipsis">
      parse_tn13_header
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.parse_tn14_header" class="md-nav__link">
    <span class="md-ellipsis">
      parse_tn14_header
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.find_date_in_replacemnt_file" class="md-nav__link">
    <span class="md-ellipsis">
      find_date_in_replacemnt_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_C10_11_replcmnt_coeff" class="md-nav__link">
    <span class="md-ellipsis">
      extract_C10_11_replcmnt_coeff
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_C20_replcmnt_coeff" class="md-nav__link">
    <span class="md-ellipsis">
      extract_C20_replcmnt_coeff
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_C30_replcmnt_coeff" class="md-nav__link">
    <span class="md-ellipsis">
      extract_C30_replcmnt_coeff
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.sub2ind" class="md-nav__link">
    <span class="md-ellipsis">
      sub2ind
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.cklm2sc_new" class="md-nav__link">
    <span class="md-ellipsis">
      cklm2sc_new
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_SH_data" class="md-nav__link">
    <span class="md-ellipsis">
      extract_SH_data
    </span>
  </a>
  
    <nav class="md-nav" aria-label="extract_SH_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_SH_data--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_SH_data--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_deg1_coeff_tn13" class="md-nav__link">
    <span class="md-ellipsis">
      extract_deg1_coeff_tn13
    </span>
  </a>
  
    <nav class="md-nav" aria-label="extract_deg1_coeff_tn13">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_deg1_coeff_tn13--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_deg1_coeff_tn13--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_deg2_3_coeff_tn14" class="md-nav__link">
    <span class="md-ellipsis">
      extract_deg2_3_coeff_tn14
    </span>
  </a>
  
    <nav class="md-nav" aria-label="extract_deg2_3_coeff_tn14">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_deg2_3_coeff_tn14--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.extract_deg2_3_coeff_tn14--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.read_GRACE_SH_paths" class="md-nav__link">
    <span class="md-ellipsis">
      read_GRACE_SH_paths
    </span>
  </a>
  
    <nav class="md-nav" aria-label="read_GRACE_SH_paths">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.read_GRACE_SH_paths--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.read_GRACE_SH_paths--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#computing-ling-term-mean" class="md-nav__link">
    <span class="md-ellipsis">
      Computing Ling Term Mean
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.io.load_longterm_mean" class="md-nav__link">
    <span class="md-ellipsis">
      load_longterm_mean
    </span>
  </a>
  
    <nav class="md-nav" aria-label="load_longterm_mean">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.load_longterm_mean--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyshbundle.io.load_longterm_mean--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physical-and-geodetic-constants" class="md-nav__link">
    <span class="md-ellipsis">
      Physical and Geodetic Constants
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pyshbundle.GRACEconstants" class="md-nav__link">
    <span class="md-ellipsis">
      GRACEconstants
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    <span class="md-ellipsis">
      Reference
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="load-data">Load Data<a class="headerlink" href="#load-data" title="Permanent link">&para;</a></h1>
<h3 id="_1"><a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="pyshbundle.io.parse_jpl_file"></a>
    <div class="doc doc-contents first">

        <p>Reads the spherical harmonic data provided by JPL</p>
<h3 id="pyshbundle.io.parse_jpl_file--parameters">Parameters<a class="headerlink" href="#pyshbundle.io.parse_jpl_file--parameters" title="Permanent link">&para;</a></h3>
<p>file_path : str
    Absolute path to the file</p>

            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_jpl_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reads the spherical harmonic data provided by JPL</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Absolute path to the file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># ensure that the file path is valid then proceed</span>

    <span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;JPL&#39;</span>

    <span class="c1"># check if the file is ziped or not</span>

    <span class="k">if</span> <span class="n">file_path</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;.gz&#39;</span><span class="p">:</span>
        <span class="c1"># open the file and read the lines</span>
        <span class="k">with</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>

            <span class="c1"># read the file line wise -&gt; obtain a list of bytes</span>
            <span class="n">info_lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="n">num_lines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">info_lines</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">info_lines</span><span class="p">)):</span>
                <span class="c1"># find the end of header sentence in the text file</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">info_lines</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;# End of YAML header</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,):</span>
                    <span class="n">end_of_header_idx</span> <span class="o">=</span> <span class="n">i</span>
                    <span class="k">break</span>

        <span class="c1"># everything after the header is the numerical data    </span>
        <span class="n">header_info</span> <span class="o">=</span> <span class="n">info_lines</span><span class="p">[:</span><span class="n">end_of_header_idx</span><span class="p">]</span>

        <span class="c1"># parse the header strings to extract relavant metadata info</span>
        <span class="n">jpl_header</span> <span class="o">=</span> <span class="n">parse_jpl_header</span><span class="p">(</span><span class="n">header_info</span><span class="p">)</span>

        <span class="c1"># parse the header strings to extract relavant metadata info</span>
        <span class="n">jpl_data</span> <span class="o">=</span> <span class="n">extract_SH_data</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;itsg&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">jpl_header</span><span class="p">,</span> <span class="n">jpl_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">



<a id="pyshbundle.io.parse_jpl_header"></a>
    <div class="doc doc-contents first">

            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_jpl_header</span><span class="p">(</span><span class="n">header_info</span><span class="p">):</span>

    <span class="c1"># parse the header info passed by the reader in as list of bytes</span>
    <span class="c1"># create a dictionary with key = important params from header file</span>

    <span class="n">header</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># important info from header file</span>
    <span class="c1"># Dimension - Degree and Order</span>
    <span class="c1"># normalization info</span>
    <span class="c1"># permanent_tide_flag</span>
    <span class="c1"># earth_gravity_param - G*M_earth with units and value</span>
    <span class="c1"># mean_equator_radius - units and value</span>
    <span class="c1"># processing_level</span>
    <span class="c1"># product_version</span>
    <span class="c1"># conventions</span>
    <span class="c1"># institution</span>
    <span class="c1"># title</span>
    <span class="c1"># time_coverage_start</span>
    <span class="c1"># time_coverage_end</span>
    <span class="c1"># unused_days</span>

    <span class="n">normal_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;institution&#39;</span><span class="p">,</span> <span class="s1">&#39;product_version&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;processing_level&#39;</span><span class="p">,</span> <span class="s1">&#39;normalization&#39;</span><span class="p">,</span> <span class="s1">&#39;permanent_tide_flag&#39;</span><span class="p">,</span>
                    <span class="p">]</span>
    <span class="n">dimension_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;degree&#39;</span><span class="p">,</span> <span class="s1">&#39;order&#39;</span><span class="p">]</span>
    <span class="n">date_time_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;time_coverage_start&#39;</span><span class="p">,</span> <span class="s1">&#39;time_coverage_end&#39;</span><span class="p">,</span> <span class="s1">&#39;unused_days&#39;</span><span class="p">]</span>
    <span class="n">physical_constant_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;earth_gravity_param&#39;</span><span class="p">,</span> <span class="s1">&#39;mean_equator_radius&#39;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">normal_keys</span><span class="p">:</span>
        <span class="n">key_index_in_header</span> <span class="o">=</span> <span class="n">find_word</span><span class="p">(</span><span class="n">header_info</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="c1"># print(f&quot;{key} - header line = {key_index_in_header +1} value= {&#39; &#39;.join(parse_lines(header_info[key_index_in_header])[3:])[: -3]}&quot;)</span>
        <span class="n">header</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parse_lines</span><span class="p">(</span><span class="n">header_info</span><span class="p">[</span><span class="n">key_index_in_header</span><span class="p">])[</span><span class="mi">3</span><span class="p">:])[:</span> <span class="o">-</span><span class="mi">3</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dimension_keys</span><span class="p">:</span>
        <span class="n">key_index_in_header</span> <span class="o">=</span> <span class="n">find_word</span><span class="p">(</span><span class="n">header_info</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="n">val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parse_lines</span><span class="p">(</span><span class="n">header_info</span><span class="p">[</span><span class="n">key_index_in_header</span><span class="p">],</span> <span class="n">parse_fmt</span><span class="o">=</span><span class="s1">&#39;\s+&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">:])[:</span> <span class="o">-</span><span class="mi">3</span><span class="p">])</span>
        <span class="c1"># print(f&quot;{key} - {val}&quot;)</span>
        <span class="n">header</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">date_time_keys</span><span class="p">:</span>
        <span class="c1"># TODO: Look back and find what you meant.... </span>
        <span class="n">key_index_in_header</span> <span class="o">=</span> <span class="n">find_word</span><span class="p">(</span><span class="n">header_info</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="c1"># find a way to make it date time object so it can be used later</span>
        <span class="k">pass</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">physical_constant_keys</span><span class="p">:</span>
        <span class="n">key_index_in_header</span> <span class="o">=</span> <span class="n">find_word</span><span class="p">(</span><span class="n">header_info</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

        <span class="n">const_long_name</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parse_lines</span><span class="p">(</span><span class="n">header_info</span><span class="p">[</span><span class="n">key_index_in_header</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])[</span><span class="mi">3</span><span class="p">:])[:</span> <span class="o">-</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">const_units</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parse_lines</span><span class="p">(</span><span class="n">header_info</span><span class="p">[</span><span class="n">key_index_in_header</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])[</span><span class="mi">3</span><span class="p">:])[:</span> <span class="o">-</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">const_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parse_lines</span><span class="p">(</span><span class="n">header_info</span><span class="p">[</span><span class="n">key_index_in_header</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])[</span><span class="mi">3</span><span class="p">:])[:</span> <span class="o">-</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">const_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="n">const_units</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">const_value</span><span class="p">}</span>
        <span class="c1"># returning a dict with value and corresponding units</span>
        <span class="n">header</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">const_dict</span>

    <span class="k">return</span> <span class="n">header</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">



<a id="pyshbundle.io.parse_lines"></a>
    <div class="doc doc-contents first">

            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_lines</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">parse_fmt</span><span class="o">=</span><span class="s1">&#39;\s+&#39;</span><span class="p">):</span>
    <span class="c1">#  parses the liness and reutrns an array</span>
    <span class="c1"># &#39;\s+&#39; returns array with no whitespace</span>

    <span class="n">parsed_array</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">parse_fmt</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">parsed_array</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">



<a id="pyshbundle.io.parse_csr_file"></a>
    <div class="doc doc-contents first">

            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_csr_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="c1"># ensure that the file path is valid then proceed</span>

    <span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;CSR&#39;</span>

    <span class="c1"># check if the file is ziped or not</span>
    <span class="k">if</span> <span class="n">file_path</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;.gz&#39;</span><span class="p">:</span>
        <span class="c1"># open the file and read the lines</span>
        <span class="k">with</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>

            <span class="c1"># read the file line wise -&gt; obtain a list of bytes</span>
            <span class="n">info_lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="n">num_lines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">info_lines</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">info_lines</span><span class="p">)):</span>
                <span class="c1"># find the index of line which indicates end of header info</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">info_lines</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;# End of YAML header</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,):</span>
                    <span class="n">end_of_header_idx</span> <span class="o">=</span> <span class="n">i</span>
                    <span class="k">break</span>

        <span class="n">header_info</span> <span class="o">=</span> <span class="n">info_lines</span><span class="p">[:</span><span class="n">end_of_header_idx</span><span class="p">]</span>

        <span class="c1"># parse the header strings to extract relavant metadata info</span>
        <span class="n">csr_header</span> <span class="o">=</span> <span class="n">header_info</span> <span class="c1"># parse_jpl_header(header_info)</span>

        <span class="c1"># parse the data strings to extract numeric data in suitable matrix fmt</span>
        <span class="n">csr_data</span> <span class="o">=</span> <span class="n">extract_SH_data</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;csr&#39;</span><span class="p">)</span>

        <span class="c1"># Organize the data into either matrix, dataframe or dictionary format      </span>

    <span class="k">return</span> <span class="n">csr_header</span><span class="p">,</span> <span class="n">csr_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">



<a id="pyshbundle.io.parse_csr_header"></a>
    <div class="doc doc-contents first">

            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_csr_header</span><span class="p">():</span>

    <span class="c1"># similar to JPL one</span>

    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Similar to `parse_jpl_header`... not yet implemented seperately.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">



<a id="pyshbundle.io.parse_itsg_file"></a>
    <div class="doc doc-contents first">

            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_itsg_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>

    <span class="c1"># ensure that the file path is valid then proceed</span>

    <span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;CSR&#39;</span>

    <span class="c1"># check if the file is ziped or not</span>

    <span class="c1"># open the file and read the lines</span>
    <span class="k">if</span> <span class="n">file_path</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;.gfc&#39;</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>

            <span class="c1"># read the file line wise -&gt; obtain a list of bytes</span>
            <span class="n">info_lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="n">num_lines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">info_lines</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">info_lines</span><span class="p">)):</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">info_lines</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;end_of_head ==================================================================================</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,):</span>
                    <span class="n">end_of_header_idx</span> <span class="o">=</span> <span class="n">i</span>
                    <span class="k">break</span>

        <span class="n">istg_header</span> <span class="o">=</span> <span class="n">info_lines</span><span class="p">[:</span><span class="n">end_of_header_idx</span><span class="p">]</span>

        <span class="c1"># parse the header strings to extract relavant metadata info</span>
        <span class="n">itsg_data</span> <span class="o">=</span> <span class="n">extract_SH_data</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;itsg&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">istg_header</span><span class="p">,</span> <span class="n">itsg_data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">



<a id="pyshbundle.io.parse_itsg_header"></a>
    <div class="doc doc-contents first">

            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_itsg_header</span><span class="p">(</span><span class="n">header_info</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>

    <span class="n">normal_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;modelname&#39;</span><span class="p">,</span> <span class="s1">&#39;product_type&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;norm&#39;</span><span class="p">,</span> <span class="s1">&#39;tide_system&#39;</span><span class="p">,</span> <span class="s1">&#39;errors&#39;</span><span class="p">,</span> <span class="s1">&#39;earth_gravity_constant&#39;</span><span class="p">,</span> <span class="s1">&#39;radius&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;max_degree&#39;</span>
                    <span class="p">]</span>

    <span class="c1"># physical_constant_keys = [&#39;earth_gravity_constant&#39;, &#39;radius&#39;, ]</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">normal_keys</span><span class="p">:</span>

        <span class="n">key_index_in_header</span> <span class="o">=</span> <span class="n">find_word</span><span class="p">(</span><span class="n">header_info</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="c1">#print(f&quot;{key} - header line = {key_index_in_header} value= {parse_lines(header_info[key_index_in_header])[1]}&quot;)</span>

    <span class="n">model_name_idx</span> <span class="o">=</span> <span class="n">find_word</span><span class="p">(</span><span class="n">header_info</span><span class="p">,</span> <span class="s1">&#39;modelname&#39;</span><span class="p">)</span>
    <span class="n">date_str</span> <span class="o">=</span> <span class="n">parse_lines</span><span class="p">(</span><span class="n">header_info</span><span class="p">[</span><span class="n">model_name_idx</span><span class="p">])[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">7</span><span class="p">:]</span>

    <span class="n">header_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    for key in physical_constant_keys:</span>
<span class="sd">        key_index_in_header = find_word(header_info, key)</span>

<span class="sd">        const_long_name = parse_lines(header_info[key_index_in_header])[0]</span>
<span class="sd">        const_value = float(parse_lines(header_info[key_index_in_header])[1])</span>
<span class="sd">        const_dict = {&#39;long_name&#39;: const_long_name, &#39;value&#39;: const_value}</span>
<span class="sd">        print(const_dict)</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">header_dict</span><span class="p">,</span> <span class="n">date_str</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">



<a id="pyshbundle.io.parse_tn13_header"></a>
    <div class="doc doc-contents first">

            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_tn13_header</span><span class="p">(</span><span class="n">header_info</span><span class="p">):</span>

    <span class="c1"># IMP Info</span>
        <span class="c1"># - Title</span>
        <span class="c1"># - Last reported data point</span>
    <span class="c1"># Special Notes</span>
        <span class="c1"># - 1, 2, 3, 4, 5</span>

    <span class="c1"># finding the index of important sub-headers like Title and Notes</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">header_info</span><span class="p">)):</span>
        <span class="k">if</span> <span class="s1">&#39;TITLE&#39;</span> <span class="ow">in</span> <span class="n">header_info</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">title_idx</span> <span class="o">=</span> <span class="n">i</span>
            <span class="k">break</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">header_info</span><span class="p">)):</span>
        <span class="k">if</span> <span class="s1">&#39;SPECIAL NOTES&#39;</span> <span class="ow">in</span> <span class="n">header_info</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">notes_idx</span> <span class="o">=</span> <span class="n">i</span>
            <span class="k">break</span>

    <span class="c1"># The tile is</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="n">header_info</span><span class="p">[</span><span class="n">title_idx</span> <span class="o">+</span><span class="mi">1</span><span class="p">])[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span> <span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="n">header_info</span><span class="p">[</span><span class="n">title_idx</span><span class="o">+</span><span class="mi">2</span><span class="p">])[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="n">header_info</span><span class="p">[</span><span class="n">title_idx</span><span class="o">+</span><span class="mi">3</span><span class="p">])[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="c1"># TODO: later convert the str object to a date-time object</span>
    <span class="n">last_reported_date</span> <span class="o">=</span> <span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;\s+&quot;</span><span class="p">,</span> <span class="n">header_info</span><span class="p">[</span><span class="n">title_idx</span><span class="o">+</span><span class="mi">3</span><span class="p">])[</span><span class="o">-</span><span class="mi">2</span><span class="p">])[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">special_notes</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># add parsing for special notes later</span>

    <span class="k">return</span> <span class="n">title</span><span class="p">,</span> <span class="n">last_reported_date</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">



<a id="pyshbundle.io.parse_tn14_header"></a>
    <div class="doc doc-contents first">

            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_tn14_header</span><span class="p">():</span>

    <span class="c1"># Key info</span>
        <span class="c1"># - Title</span>
        <span class="c1"># - Version</span>
        <span class="c1"># - Date Span</span>
        <span class="c1"># - Notes:</span>


    <span class="c1"># Constants</span>
        <span class="c1"># - Mean C20</span>
        <span class="c1"># - Mean C30</span>
        <span class="c1"># - GM</span>
        <span class="c1"># R</span>



    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">



<a id="pyshbundle.io.find_date_in_replacemnt_file"></a>
    <div class="doc doc-contents first">

            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">find_date_in_replacemnt_file</span><span class="p">(</span><span class="n">replacemnt_mat</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">epoch_begin</span><span class="p">,</span> <span class="n">epoch_end</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="c1"># epoch_begin and epoch_end -&gt; date from the grace data file</span>
    <span class="c1"># begin_date and end_data -&gt; date from the replacement file (tn-13 or tn-14)</span>

    <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="n">replacemnt_mat</span><span class="o">.</span><span class="n">shape</span>

    <span class="k">if</span> <span class="n">file_type</span> <span class="o">==</span> <span class="s1">&#39;tn-13&#39;</span><span class="p">:</span>
        <span class="n">time_buffer_itsg</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
        <span class="n">date_idxs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="c1"># think of a rather efficient searching scheme</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
            <span class="n">begin_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">replacemnt_mat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">2</span><span class="p">])),</span> <span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
            <span class="n">end_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">replacemnt_mat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])),</span> <span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">epoch_end</span><span class="p">:</span>
                <span class="c1"># for jpl and csr</span>
                <span class="k">if</span> <span class="n">begin_date</span> <span class="o">==</span> <span class="n">epoch_begin</span> <span class="ow">and</span> <span class="n">end_date</span> <span class="o">==</span> <span class="n">epoch_end</span><span class="p">:</span>
                    <span class="n">date_idxs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;epoch-begin: </span><span class="si">{</span><span class="n">epoch_begin</span><span class="si">}</span><span class="s2">, epoch-end: </span><span class="si">{</span><span class="n">epoch_end</span><span class="si">}</span><span class="s2">, start: </span><span class="si">{</span><span class="n">begin_date</span><span class="si">}</span><span class="s2">, end: </span><span class="si">{</span><span class="n">end_date</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># for itsg</span>
                <span class="c1">#begin_date = f&quot;{begin_date.year}-{str(begin_date.month).zfill(2)}&quot;</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">epoch_begin</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="n">epoch_begin</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">epoch_begin</span><span class="p">,</span> <span class="s2">&quot;%Y-%m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">begin_date</span> <span class="o">-</span> <span class="n">time_buffer_itsg</span> <span class="o">&lt;=</span> <span class="n">epoch_begin</span> <span class="o">&lt;=</span> <span class="n">begin_date</span> <span class="o">+</span> <span class="n">time_buffer_itsg</span><span class="p">:</span>
                    <span class="n">date_idxs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;start: </span><span class="si">{</span><span class="n">begin_date</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time_buffer_itsg</span><span class="si">}</span><span class="s2">, epoch-begin: </span><span class="si">{</span><span class="n">epoch_begin</span><span class="si">}</span><span class="s2">, UB:</span><span class="si">{</span><span class="n">begin_date</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">time_buffer_itsg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


            <span class="c1"># Add bit more error handling statments </span>
            <span class="c1"># rest is fine -&gt; if inputs&#39;s right - output is right</span>

    <span class="k">elif</span> <span class="n">file_type</span> <span class="o">==</span> <span class="s2">&quot;tn-14&quot;</span><span class="p">:</span>
        <span class="c1"># there will be only one row per month -&gt; for sake of consistency using set</span>
        <span class="c1"># print(&quot;TN-14 Replacement file&quot;)</span>
        <span class="n">date_idxs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="c1"># think of a rather efficient searching scheme</span>
        <span class="n">time_buffer</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">time_buffer_itsg</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">23</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
            <span class="n">begin_date</span> <span class="o">=</span> <span class="n">julian</span><span class="o">.</span><span class="n">from_jd</span><span class="p">(</span><span class="n">replacemnt_mat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;mjd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
            <span class="n">end_date</span> <span class="o">=</span> <span class="n">julian</span><span class="o">.</span><span class="n">from_jd</span><span class="p">(</span><span class="n">replacemnt_mat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;mjd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>


            <span class="k">if</span> <span class="n">epoch_end</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">begin_date</span> <span class="o">&gt;=</span> <span class="n">epoch_begin</span> <span class="o">-</span> <span class="n">time_buffer</span> <span class="ow">and</span> <span class="n">end_date</span> <span class="o">&lt;=</span> <span class="n">epoch_end</span> <span class="o">+</span> <span class="n">time_buffer</span><span class="p">:</span>
                    <span class="n">date_idxs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;start: </span><span class="si">{</span><span class="n">begin_date</span><span class="si">}</span><span class="s2">, epoch-begin: </span><span class="si">{</span><span class="n">epoch_begin</span><span class="si">}</span><span class="s2">, LB:</span><span class="si">{</span><span class="n">epoch_begin</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time_buffer</span><span class="si">}</span><span class="s2">, UB: </span><span class="si">{</span><span class="n">epoch_end</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">time_buffer</span><span class="si">}</span><span class="s2">, end: </span><span class="si">{</span><span class="n">end_date</span><span class="si">}</span><span class="s2">, epoch-end: </span><span class="si">{</span><span class="n">epoch_end</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># for itsg</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">epoch_begin</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
                    <span class="n">epoch_begin</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">epoch_begin</span><span class="p">,</span> <span class="s2">&quot;%Y-%m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">begin_date</span> <span class="o">-</span> <span class="n">time_buffer_itsg</span> <span class="o">&lt;=</span> <span class="n">epoch_begin</span> <span class="o">&lt;=</span> <span class="n">begin_date</span> <span class="o">+</span> <span class="n">time_buffer_itsg</span><span class="p">:</span>
                    <span class="n">date_idxs</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;start: </span><span class="si">{</span><span class="n">begin_date</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">time_buffer_itsg</span><span class="si">}</span><span class="s2">, epoch-begin: </span><span class="si">{</span><span class="n">epoch_begin</span><span class="si">}</span><span class="s2">, UB:</span><span class="si">{</span><span class="n">begin_date</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">time_buffer_itsg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                        <span class="c1"># Add bit more error handling statments </span>
            <span class="c1"># rest is fine -&gt; if inputs&#39;s right - output is right</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Technical Note-13 (tn-13) and Technical Note 14 (tn-14) supported...&quot;</span><span class="p">)</span>


    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">date_idxs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">



<a id="pyshbundle.io.extract_C10_11_replcmnt_coeff"></a>
    <div class="doc doc-contents first">

            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_C10_11_replcmnt_coeff</span><span class="p">(</span><span class="n">data_tn13</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">epoch_begin</span><span class="p">,</span> <span class="n">epoch_end</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="c1"># match the date</span>
    <span class="n">file_type</span> <span class="o">=</span> <span class="s1">&#39;tn-13&#39;</span>

    <span class="k">if</span> <span class="n">epoch_end</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">end_epoch</span> <span class="o">=</span> <span class="n">epoch_end</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">end_epoch</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;jpl&#39;</span> <span class="ow">or</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;csr&#39;</span><span class="p">:</span>

        <span class="c1"># find the necessary indxes</span>
        <span class="n">replcmnt_idxs</span> <span class="o">=</span> <span class="n">find_date_in_replacemnt_file</span><span class="p">(</span><span class="n">data_tn13</span><span class="p">,</span> <span class="n">file_type</span><span class="p">,</span> <span class="n">epoch_begin</span><span class="p">,</span> <span class="n">end_epoch</span><span class="p">)</span>
        <span class="c1"># extract the coeff from tn13 for required dates</span>

        <span class="n">C10</span> <span class="o">=</span> <span class="n">data_tn13</span><span class="p">[</span><span class="n">replcmnt_idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1"># extract the coeff from tn13 for required dates</span>

        <span class="n">C11</span> <span class="o">=</span> <span class="n">data_tn13</span><span class="p">[</span><span class="n">replcmnt_idxs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;itsg&#39;</span><span class="p">:</span>

        <span class="n">replcmnt_idxs</span> <span class="o">=</span> <span class="n">find_date_in_replacemnt_file</span><span class="p">(</span><span class="n">data_tn13</span><span class="p">,</span> <span class="n">file_type</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">epoch_begin</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">epoch_begin</span><span class="o">.</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end_epoch</span><span class="p">)</span>
        <span class="c1"># extract the coeff from tn13 for required dates</span>

        <span class="n">C10</span> <span class="o">=</span> <span class="n">data_tn13</span><span class="p">[</span><span class="n">replcmnt_idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1"># extract the coeff from tn13 for required dates</span>

        <span class="n">C11</span> <span class="o">=</span> <span class="n">data_tn13</span><span class="p">[</span><span class="n">replcmnt_idxs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid Source. The sources recoginized are CSR, ITSG and JPL&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">C10</span><span class="p">,</span> <span class="n">C11</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">



<a id="pyshbundle.io.extract_C20_replcmnt_coeff"></a>
    <div class="doc doc-contents first">

            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_C20_replcmnt_coeff</span><span class="p">(</span><span class="n">data_tn14</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">epoch_begin</span><span class="p">,</span> <span class="n">epoch_end</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># For JPL </span>
    <span class="c1"># generating a CLM array for C20 and C30</span>
    <span class="c1"># NOTE: Zonal coeff. does not have Slm - its taken as 0</span>
    <span class="k">if</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;jpl&#39;</span> <span class="ow">or</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;csr&#39;</span><span class="p">:</span>

        <span class="n">replcmnt_idxs</span>  <span class="o">=</span> <span class="n">find_date_in_replacemnt_file</span><span class="p">(</span><span class="n">data_tn14</span><span class="p">,</span> <span class="s1">&#39;tn-14&#39;</span><span class="p">,</span> <span class="n">epoch_begin</span><span class="p">,</span> <span class="n">epoch_end</span><span class="p">)</span>

        <span class="n">C20</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data_tn14</span><span class="p">[</span><span class="n">replcmnt_idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">data_tn14</span><span class="p">[</span><span class="n">replcmnt_idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="k">elif</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;itsg&#39;</span><span class="p">:</span>
        <span class="n">replcmnt_idxs</span>  <span class="o">=</span> <span class="n">find_date_in_replacemnt_file</span><span class="p">(</span><span class="n">data_tn14</span><span class="p">,</span> <span class="s1">&#39;tn-14&#39;</span><span class="p">,</span> <span class="n">epoch_begin</span><span class="p">,</span> <span class="n">epoch_end</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="n">C20</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data_tn14</span><span class="p">[</span><span class="n">replcmnt_idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">data_tn14</span><span class="p">[</span><span class="n">replcmnt_idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>


    <span class="k">return</span> <span class="n">C20</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">



<a id="pyshbundle.io.extract_C30_replcmnt_coeff"></a>
    <div class="doc doc-contents first">

            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_C30_replcmnt_coeff</span><span class="p">(</span><span class="n">data_tn14</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">epoch_begin</span><span class="p">,</span> <span class="n">epoch_end</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;jpl&#39;</span> <span class="ow">or</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;csr&#39;</span><span class="p">:</span>

        <span class="n">replcmnt_idxs</span>  <span class="o">=</span> <span class="n">find_date_in_replacemnt_file</span><span class="p">(</span><span class="n">data_tn14</span><span class="p">,</span> <span class="s1">&#39;tn-14&#39;</span><span class="p">,</span> <span class="n">epoch_begin</span><span class="p">,</span> <span class="n">epoch_end</span><span class="p">)</span>

        <span class="c1"># think about handling nan values while replacing and its impact</span>
        <span class="c1"># handle the nan issue</span>

        <span class="n">C30</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data_tn14</span><span class="p">[</span><span class="n">replcmnt_idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">data_tn14</span><span class="p">[</span><span class="n">replcmnt_idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

        <span class="c1"># replace nan values with zeros</span>
        <span class="n">C30</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">C30</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">elif</span> <span class="n">source</span> <span class="o">==</span> <span class="s1">&#39;itsg&#39;</span><span class="p">:</span>
        <span class="n">replcmnt_idxs</span>  <span class="o">=</span> <span class="n">find_date_in_replacemnt_file</span><span class="p">(</span><span class="n">data_tn14</span><span class="p">,</span> <span class="s1">&#39;tn-14&#39;</span><span class="p">,</span> <span class="n">epoch_begin</span><span class="p">,</span> <span class="n">epoch_end</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="n">C30</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data_tn14</span><span class="p">[</span><span class="n">replcmnt_idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">data_tn14</span><span class="p">[</span><span class="n">replcmnt_idxs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

        <span class="c1"># replace nan values with zeros</span>
        <span class="n">C30</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">C30</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="n">C30</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">



<a id="pyshbundle.io.sub2ind"></a>
    <div class="doc doc-contents first">

            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sub2ind</span><span class="p">(</span><span class="n">array_shape</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
    <span class="c1"># rows, list need to be linear array</span>
    <span class="k">return</span> <span class="n">rows</span><span class="o">*</span><span class="n">array_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">cols</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">



<a id="pyshbundle.io.cklm2sc_new"></a>
    <div class="doc doc-contents first">

        <p>Transforms the spherical harmonics coefficients data in clm or klm format into a SC matrix</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>clm data - [l, m, c_lm, s_lm]
</code></pre></div></td></tr></table></div>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>clm_mat</code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lmax</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>maximum degree of spherical harmonic expansion</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>_type_</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cklm2sc_new</span><span class="p">(</span><span class="n">clm_mat</span><span class="p">,</span> <span class="n">lmax</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transforms the spherical harmonics coefficients data in clm or klm format into a SC matrix</span>

<span class="sd">        clm data - [l, m, c_lm, s_lm]</span>

<span class="sd">    Args:</span>
<span class="sd">        clm_mat (np.ndarray): _description_</span>
<span class="sd">        lmax (int): maximum degree of spherical harmonic expansion</span>

<span class="sd">    Returns:</span>
<span class="sd">        _type_: _description_</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># initialise an empty sc matrix</span>
    <span class="n">sc_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">lmax</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">lmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">dev_sc_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">lmax</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">lmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>

    <span class="c1"># navigating the maze of indices</span>

    <span class="c1"># Use logical indices</span>

    <span class="c1"># sc mat requires padding - Taken care of by the earlier initialisation</span>
    <span class="c1"># </span>
    <span class="c1"># filling the value at appropriate locaation is the key</span>
    <span class="c1"># </span>
    <span class="c1"># Approach-1</span>
        <span class="c1"># run through rows(degree) and fill the cols(order) respectively</span>

    <span class="c1"># Approach -2</span>
        <span class="c1"># create a row_func s.t. [....., C22, C21, C20, S21, S22, .......]</span>
        <span class="c1"># then stack the rows</span>

    <span class="c1"># First flatten the SC matrix - column wise aka Fortran style</span>
    <span class="c1"># get the flattented idx to be raplaced using sub2ind </span>
    <span class="c1"># replace the indices at those locations using </span>
    <span class="c1"># unflatten the matrix</span>

    <span class="n">shape_sc</span> <span class="o">=</span> <span class="n">sc_mat</span><span class="o">.</span><span class="n">shape</span>

    <span class="c1"># following the approach similar to Octave implementation</span>
    <span class="c1"># using matrix operations to improve the time efficiency as compared to looping</span>
    <span class="n">idx_s</span> <span class="o">=</span> <span class="n">sub2ind</span><span class="p">(</span><span class="n">sc_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">clm_mat</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">),</span> <span class="p">(</span><span class="n">lmax</span> <span class="o">-</span> <span class="n">clm_mat</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span>
    <span class="n">idx_c</span> <span class="o">=</span> <span class="n">sub2ind</span><span class="p">(</span><span class="n">sc_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">clm_mat</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">),</span> <span class="p">(</span><span class="n">lmax</span> <span class="o">+</span> <span class="n">clm_mat</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span>


    <span class="n">flat_sc</span> <span class="o">=</span> <span class="n">sc_mat</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">)</span>
    <span class="c1"># Attention first place the slm coeff. or else it will relace zonal clm coeff.</span>
    <span class="n">flat_sc</span><span class="p">[</span><span class="n">idx_s</span><span class="p">]</span> <span class="o">=</span> <span class="n">clm_mat</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">flat_sc</span><span class="p">[</span><span class="n">idx_c</span><span class="p">]</span> <span class="o">=</span> <span class="n">clm_mat</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>

    <span class="n">flat_sc2</span> <span class="o">=</span> <span class="n">dev_sc_mat</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="s2">&quot;F&quot;</span><span class="p">)</span>
    <span class="n">flat_sc2</span><span class="p">[</span><span class="n">idx_s</span><span class="p">]</span> <span class="o">=</span> <span class="n">clm_mat</span><span class="p">[:,</span> <span class="mi">5</span><span class="p">]</span>
    <span class="n">flat_sc2</span><span class="p">[</span><span class="n">idx_c</span><span class="p">]</span> <span class="o">=</span> <span class="n">clm_mat</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>

    <span class="n">dev_scmat</span> <span class="o">=</span> <span class="n">flat_sc2</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape_sc</span><span class="p">)</span>

    <span class="n">scmat</span> <span class="o">=</span> <span class="n">flat_sc</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape_sc</span><span class="p">)</span>

    <span class="c1"># with one flag include for </span>

    <span class="k">return</span> <span class="n">scmat</span><span class="p">,</span> <span class="n">dev_scmat</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">



<a id="pyshbundle.io.extract_SH_data"></a>
    <div class="doc doc-contents first">

        <p>Extracts the spherical harmonic coefficients from all the given files</p>
<p>Currently supports JPL, CSR, and ITSG data sources ONLY.
Extracts the spherical harmonic coefficients from the given file and returns them in a dictionary.
Uses the degree and order of a coefficient as the key and the coefficient values as the value.</p>
<h3 id="pyshbundle.io.extract_SH_data--parameters">Parameters<a class="headerlink" href="#pyshbundle.io.extract_SH_data--parameters" title="Permanent link">&para;</a></h3>
<p>file_path : str
    Absolute path to the file
source : str
    Source of the data (JPL, CSR, or ITSG)</p>
<h3 id="pyshbundle.io.extract_SH_data--returns">Returns<a class="headerlink" href="#pyshbundle.io.extract_SH_data--returns" title="Permanent link">&para;</a></h3>
<p>dict
    Dictionary containing the coefficients and time coverage start and end dates</p>

            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_SH_data</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts the spherical harmonic coefficients from all the given files</span>

<span class="sd">    Currently supports JPL, CSR, and ITSG data sources ONLY.</span>
<span class="sd">    Extracts the spherical harmonic coefficients from the given file and returns them in a dictionary.</span>
<span class="sd">    Uses the degree and order of a coefficient as the key and the coefficient values as the value.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Absolute path to the file</span>
<span class="sd">    source : str</span>
<span class="sd">        Source of the data (JPL, CSR, or ITSG)</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    dict</span>
<span class="sd">        Dictionary containing the coefficients and time coverage start and end dates</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize an empty dictionary to store the coefficients and dates</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;coefficients&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;time_coverage_start&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;time_coverage_end&#39;</span><span class="p">:</span> <span class="kc">None</span>
    <span class="p">}</span>


    <span class="c1"># Regular expression pattern to match the lines with coefficients</span>
    <span class="n">coeff_pattern_csr</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^GRCOF2\s+(\d+)\s+(\d+)\s+([-+]?\d*\.\d+E[-+]?\d+)\s+([-+]?\d*\.\d+E[-+]?\d+)\s+([-+]?\d*\.\d+E[-+]?\d+)\s+([-+]?\d*\.\d+E[-+]?\d+)\s+(\d+\.\d+)\s+(\d+\.\d+)\s+&#39;</span><span class="p">)</span>
    <span class="n">coeff_pattern_jpl</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^GRCOF2\s+(\d+)\s+(\d+)\s+([-+]?\d*\.\d+e[-+]?\d+)\s+([-+]?\d*\.\d+e[-+]?\d+)\s+([-+]?\d*\.\d+e[-+]?\d+)\s+([-+]?\d*\.\d+e[-+]?\d+)\s+(\d+\.\d+)\s+(\d+\.\d+)&#39;</span><span class="p">)</span>
    <span class="n">coeff_pattern_itsg</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^gfc\s+(\d+)\s+(\d+)\s+([-+]?\d*\.\d+e[-+]?\d+)\s+([-+]?\d*\.\d+e[-+]?\d+)\s+([-+]?\d*\.\d+e[-+]?\d+)\s+([-+]?\d*\.\d+e[-+]?\d+)$&#39;</span><span class="p">)</span>


    <span class="k">if</span> <span class="n">source</span><span class="o">==</span><span class="s1">&#39;jpl&#39;</span><span class="p">:</span> <span class="n">coeff_pattern</span><span class="o">=</span><span class="n">coeff_pattern_jpl</span>
    <span class="k">elif</span> <span class="n">source</span><span class="o">==</span><span class="s1">&#39;csr&#39;</span><span class="p">:</span> <span class="n">coeff_pattern</span><span class="o">=</span><span class="n">coeff_pattern_csr</span>
    <span class="k">elif</span> <span class="n">source</span><span class="o">==</span><span class="s1">&#39;itsg&#39;</span><span class="p">:</span> <span class="n">coeff_pattern</span><span class="o">=</span><span class="n">coeff_pattern_itsg</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid source, pyshbundle only supports JPL, CSR, and ITSG&quot;</span><span class="p">)</span>


    <span class="c1"># Regular expression patterns to match the time coverage start and end lines</span>
    <span class="n">start_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;time_coverage_start\s*:\s*([\d\-T:.]+)&#39;</span><span class="p">)</span>
    <span class="n">end_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;time_coverage_end\s*:\s*([\d\-T:.]+)&#39;</span><span class="p">)</span>
    <span class="n">timeindex_itsg</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^modelname\s+(.+)$&#39;</span><span class="p">)</span>


    <span class="c1"># Open and read the gzipped file to extract the time coverage start and end dates</span>
    <span class="k">if</span> <span class="n">source</span><span class="o">==</span><span class="s1">&#39;itsg&#39;</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
                <span class="c1"># Strip any leading/trailing whitespace characters</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

                <span class="c1"># Search for time coverage start</span>
                <span class="n">start_match</span> <span class="o">=</span> <span class="n">timeindex_itsg</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">start_match</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;time_coverage_start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

                <span class="c1"># Break the loop if both dates are found</span>
                <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;time_coverage_start&#39;</span><span class="p">]:</span>
                    <span class="k">break</span>
            <span class="c1"># File is automatically closed here due to the &#39;with&#39; statement</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
                <span class="c1"># Strip any leading/trailing whitespace characters</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="c1"># print(line)</span>

                <span class="c1"># Search for the coefficient pattern in the line</span>
                <span class="n">coeff_match</span> <span class="o">=</span> <span class="n">coeff_pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">coeff_match</span><span class="p">:</span>
                    <span class="c1"># Extract degree, order, Clm, and Slm</span>
                    <span class="n">degree</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">coeff_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                    <span class="n">order</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">coeff_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
                    <span class="n">clm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">coeff_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
                    <span class="n">slm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">coeff_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
                    <span class="n">clm_sdev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">coeff_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
                    <span class="n">slm_sdev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">coeff_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>

                    <span class="c1"># Store the coefficients in the dictionary</span>
                    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;coefficients&#39;</span><span class="p">][(</span><span class="n">degree</span><span class="p">,</span> <span class="n">order</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Clm&#39;</span><span class="p">:</span> <span class="n">clm</span><span class="p">,</span> <span class="s1">&#39;Slm&#39;</span><span class="p">:</span> <span class="n">slm</span><span class="p">,</span>
                                                            <span class="s1">&#39;Clm_sdev&#39;</span><span class="p">:</span> <span class="n">clm_sdev</span><span class="p">,</span> <span class="s1">&#39;Slm_sdev&#39;</span><span class="p">:</span> <span class="n">slm_sdev</span><span class="p">}</span>



    <span class="k">elif</span> <span class="n">source</span><span class="o">==</span><span class="s1">&#39;csr&#39;</span> <span class="ow">or</span> <span class="n">source</span><span class="o">==</span><span class="s1">&#39;jpl&#39;</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>   <span class="c1"># gzip.open</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
                <span class="c1"># Strip any leading/trailing whitespace characters</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

                <span class="c1"># Search for time coverage start</span>
                <span class="n">start_match</span> <span class="o">=</span> <span class="n">start_pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">start_match</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;time_coverage_start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

                <span class="c1"># Search for time coverage end</span>
                <span class="n">end_match</span> <span class="o">=</span> <span class="n">end_pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">end_match</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;time_coverage_end&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">end_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

                <span class="c1"># Break the loop if both dates are found</span>
                <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;time_coverage_start&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;time_coverage_end&#39;</span><span class="p">]:</span>
                    <span class="k">break</span>
            <span class="c1"># File is automatically closed here due to the &#39;with&#39; statement</span>


        <span class="c1"># Open and read the gzipped file again to extract the coefficients</span>
        <span class="k">with</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
                <span class="c1"># Strip any leading/trailing whitespace characters</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="c1"># print(line)</span>

                <span class="c1"># Search for the coefficient pattern in the line</span>
                <span class="n">coeff_match</span> <span class="o">=</span> <span class="n">coeff_pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">coeff_match</span><span class="p">:</span>
                    <span class="c1"># Extract degree, order, Clm, and Slm</span>
                    <span class="n">degree</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">coeff_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                    <span class="n">order</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">coeff_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
                    <span class="n">clm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">coeff_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
                    <span class="n">slm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">coeff_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
                    <span class="n">clm_sdev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">coeff_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
                    <span class="n">slm_sdev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">coeff_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>

                    <span class="c1"># Store the coefficients in the dictionary</span>
                    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;coefficients&#39;</span><span class="p">][(</span><span class="n">degree</span><span class="p">,</span> <span class="n">order</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Clm&#39;</span><span class="p">:</span> <span class="n">clm</span><span class="p">,</span> <span class="s1">&#39;Slm&#39;</span><span class="p">:</span> <span class="n">slm</span><span class="p">,</span>
                                                            <span class="s1">&#39;Clm_sdev&#39;</span><span class="p">:</span> <span class="n">clm_sdev</span><span class="p">,</span> <span class="s1">&#39;Slm_sdev&#39;</span><span class="p">:</span> <span class="n">slm_sdev</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">



<a id="pyshbundle.io.extract_deg1_coeff_tn13"></a>
    <div class="doc doc-contents first">

        <p>Extracts the degree 1 coefficients from the given TN-13 file</p>
<p>Ensure the TN-13 file used is the one recommended by respective data centres (JPL, CSR, or ITSG).
Similar to extract_SH_data, but specifically for TN-13 files.
Returns degree 1 replacement coefficients as a dictionary.
Uses the degree and order of a coefficient as the key and the coefficient values as the value.</p>
<h3 id="pyshbundle.io.extract_deg1_coeff_tn13--parameters">Parameters<a class="headerlink" href="#pyshbundle.io.extract_deg1_coeff_tn13--parameters" title="Permanent link">&para;</a></h3>
<p>file_path : str
    Absolute path to the file</p>
<h3 id="pyshbundle.io.extract_deg1_coeff_tn13--returns">Returns<a class="headerlink" href="#pyshbundle.io.extract_deg1_coeff_tn13--returns" title="Permanent link">&para;</a></h3>
<p>dict
    Dictionary containing the degree 1 (order 1) coefficients and time coverage start and end dates</p>

            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_deg1_coeff_tn13</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts the degree 1 coefficients from the given TN-13 file</span>

<span class="sd">    Ensure the TN-13 file used is the one recommended by respective data centres (JPL, CSR, or ITSG).</span>
<span class="sd">    Similar to extract_SH_data, but specifically for TN-13 files.</span>
<span class="sd">    Returns degree 1 replacement coefficients as a dictionary.</span>
<span class="sd">    Uses the degree and order of a coefficient as the key and the coefficient values as the value.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Absolute path to the file</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    dict</span>
<span class="sd">        Dictionary containing the degree 1 (order 1) coefficients and time coverage start and end dates</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>

            <span class="c1"># Extract data using regex</span>
            <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^GRCOF2\s+(\d+)\s+(\d+)\s+([-+]?\d*\.\d+e[-+]?\d+)\s+([-+]?\d*\.\d+e[-+]?\d+)\s+([-+]?\d*\.\d+e[-+]?\d+)\s+([-+]?\d*\.\d+e[-+]?\d+)\s+(\d+\.\d+)\s+(\d+\.\d+)&#39;</span><span class="p">)</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="n">degree</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                <span class="n">order</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
                <span class="n">Clm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
                <span class="n">Slm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
                <span class="n">Clm_sdev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
                <span class="n">Slm_sdev</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
                <span class="n">epoch_begin</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
                <span class="n">epoch_end</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

                <span class="c1"># Use epoch start as key but in yyyy-mm-dd format</span>
                <span class="n">epoch_key</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">epoch_begin</span><span class="p">,</span> <span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">.%H%M%S&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">)</span>
                <span class="n">data_dict</span><span class="p">[</span><span class="n">epoch_key</span><span class="p">,</span> <span class="n">degree</span><span class="p">,</span> <span class="n">order</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;degree&#39;</span><span class="p">:</span> <span class="n">degree</span><span class="p">,</span>
                    <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="n">order</span><span class="p">,</span>
                    <span class="s1">&#39;Clm&#39;</span><span class="p">:</span> <span class="n">Clm</span><span class="p">,</span>
                    <span class="s1">&#39;Slm&#39;</span><span class="p">:</span> <span class="n">Slm</span><span class="p">,</span>
                    <span class="s1">&#39;Clm_sdev&#39;</span><span class="p">:</span> <span class="n">Clm_sdev</span><span class="p">,</span>
                    <span class="s1">&#39;Slm_sdev&#39;</span><span class="p">:</span> <span class="n">Slm_sdev</span><span class="p">,</span>
                    <span class="s1">&#39;epoch_begin&#39;</span><span class="p">:</span> <span class="n">epoch_begin</span><span class="p">,</span>
                    <span class="s1">&#39;epoch_end&#39;</span><span class="p">:</span> <span class="n">epoch_end</span><span class="p">,</span>
                <span class="p">}</span>
    <span class="c1"># Print a sample of the data to check if it&#39;s parsed correctly</span>
    <span class="c1"># for key in sorted(data_dict.keys())[:5]:  # print first 5 entries</span>
    <span class="c1">#     print(f&quot;{key}: {data_dict[key]}&quot;)</span>
    <span class="k">return</span> <span class="n">data_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">



<a id="pyshbundle.io.extract_deg2_3_coeff_tn14"></a>
    <div class="doc doc-contents first">

        <p>Extracts the degree 2 and 3 coefficients from the given file</p>
<p>Ensure the TN-14 file used is the one recommended by respective data centres (JPL, CSR, or ITSG).
Similar to extract_SH_data, but specifically for TN-14 files.
Returns degree 2, 3 replacement coefficients as a dictionary.
Uses the degree and order of a coefficient as the key and the coefficient values as the value.</p>
<h3 id="pyshbundle.io.extract_deg2_3_coeff_tn14--parameters">Parameters<a class="headerlink" href="#pyshbundle.io.extract_deg2_3_coeff_tn14--parameters" title="Permanent link">&para;</a></h3>
<p>file_path : str
    Absolute path to the file</p>
<h3 id="pyshbundle.io.extract_deg2_3_coeff_tn14--returns">Returns<a class="headerlink" href="#pyshbundle.io.extract_deg2_3_coeff_tn14--returns" title="Permanent link">&para;</a></h3>
<p>dict
    Dictionary containing the degree 2,3 (order 0) coefficients and time coverage start and end dates</p>

            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_deg2_3_coeff_tn14</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extracts the degree 2 and 3 coefficients from the given file</span>

<span class="sd">    Ensure the TN-14 file used is the one recommended by respective data centres (JPL, CSR, or ITSG).</span>
<span class="sd">    Similar to extract_SH_data, but specifically for TN-14 files.</span>
<span class="sd">    Returns degree 2, 3 replacement coefficients as a dictionary.</span>
<span class="sd">    Uses the degree and order of a coefficient as the key and the coefficient values as the value.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file_path : str</span>
<span class="sd">        Absolute path to the file</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    dict</span>
<span class="sd">        Dictionary containing the degree 2,3 (order 0) coefficients and time coverage start and end dates</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>

            <span class="c1"># Extract data using regex</span>
            <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
                <span class="sa">r</span><span class="s1">&#39;(\d+\.\d+)\s+(\d+\.\d+)\s+([-\d.eE+]+)\s+([-\d.eE+]+)\s+([-\d.eE+]+)\s+([-\d.eE+]+|NaN)?\s+([-\d.eE+]+|NaN)?\s+([-\d.eE+]+|NaN)?\s+(\d+\.\d+)\s+(\d+\.\d+)&#39;</span><span class="p">)</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="n">mjd_start</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                <span class="n">year_frac_start</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
                <span class="n">c20</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
                <span class="n">c20_mean_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
                <span class="n">c20_sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
                <span class="n">c30</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
                <span class="n">c30_mean_diff</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
                <span class="n">c30_sigma</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
                <span class="n">mjd_end</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
                <span class="n">year_frac_end</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

                <span class="c1"># Only add C30 if it exists (not)</span>
                <span class="k">if</span> <span class="n">c30</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;nan&#39;</span><span class="p">:</span>
                    <span class="n">c30</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">c30</span><span class="p">)</span>
                    <span class="n">c30_mean_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">c30_mean_diff</span><span class="p">)</span>
                    <span class="n">c30_sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">c30_sigma</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">c30</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="n">c30_mean_diff</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="n">c30_sigma</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="c1"># Use mjd as key but in yyyy-mm-dd format</span>
                <span class="n">mjd_key</span> <span class="o">=</span> <span class="n">julian</span><span class="o">.</span><span class="n">from_jd</span><span class="p">(</span><span class="n">mjd_start</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;mjd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m&#39;</span><span class="p">)</span>
                <span class="n">data_dict</span><span class="p">[</span><span class="n">mjd_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;year_frac_start&#39;</span><span class="p">:</span> <span class="n">year_frac_start</span><span class="p">,</span>
                    <span class="s1">&#39;mjd_start&#39;</span><span class="p">:</span> <span class="n">mjd_start</span><span class="p">,</span>
                    <span class="s1">&#39;c20&#39;</span><span class="p">:</span> <span class="n">c20</span><span class="p">,</span>
                    <span class="s1">&#39;c20_mean_diff&#39;</span><span class="p">:</span> <span class="n">c20_mean_diff</span><span class="p">,</span>
                    <span class="s1">&#39;c20_sigma&#39;</span><span class="p">:</span> <span class="n">c20_sigma</span><span class="p">,</span>
                    <span class="s1">&#39;c30&#39;</span><span class="p">:</span> <span class="n">c30</span><span class="p">,</span>
                    <span class="s1">&#39;c30_mean_diff&#39;</span><span class="p">:</span> <span class="n">c30_mean_diff</span><span class="p">,</span>
                    <span class="s1">&#39;c30_sigma&#39;</span><span class="p">:</span> <span class="n">c30_sigma</span><span class="p">,</span>
                    <span class="s1">&#39;mjd_end&#39;</span><span class="p">:</span> <span class="n">mjd_end</span><span class="p">,</span>
                    <span class="s1">&#39;year_frac_end&#39;</span><span class="p">:</span> <span class="n">year_frac_end</span>
                <span class="p">}</span>
    <span class="c1"># Print a sample of the data to check if it&#39;s parsed correctly</span>
    <span class="c1"># for key in sorted(data_dict.keys())[:5]:  # print first 5 entries</span>
    <span class="c1">#     print(f&quot;{key}: {data_dict[key]}&quot;)</span>
    <span class="k">return</span> <span class="n">data_dict</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">



<a id="pyshbundle.io.read_GRACE_SH_paths"></a>
    <div class="doc doc-contents first">

        <p>Returns path of data files, path of tn13 and path of tn14 replacement files</p>
<h3 id="pyshbundle.io.read_GRACE_SH_paths--parameters">Parameters<a class="headerlink" href="#pyshbundle.io.read_GRACE_SH_paths--parameters" title="Permanent link">&para;</a></h3>
<p>use_sample_files : (int, optional)
    Defaults to 0.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>Exception</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <h3 id="pyshbundle.io.read_GRACE_SH_paths--returns">Returns<a class="headerlink" href="#pyshbundle.io.read_GRACE_SH_paths--returns" title="Permanent link">&para;</a></h3>
<p>path_sh, path_tn13, path_tn14, source : str
    Path of data files, path of tn13 and path of tn14 replacement files, 
    source of the SH files (JPL, ITSG or CSR)</p>


<details class="remarks" open>
  <summary>Remarks</summary>
  <p>The purpose of this script is to,
firstly read what the data source is (JPL, CSR or ITSG)
read file path for GRACE L2 spherical harmonics inputs,
read replacement files for tn13 and tn14
source of the SH files (JPL, ITSG or CSR)</p>
</details>
            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_GRACE_SH_paths</span><span class="p">(</span><span class="n">use_sample_files</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns path of data files, path of tn13 and path of tn14 replacement files</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    use_sample_files : (int, optional)</span>
<span class="sd">        Defaults to 0.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: _description_</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    path_sh, path_tn13, path_tn14, source : str</span>
<span class="sd">        Path of data files, path of tn13 and path of tn14 replacement files, </span>
<span class="sd">        source of the SH files (JPL, ITSG or CSR)</span>

<span class="sd">    Remarks:</span>
<span class="sd">        The purpose of this script is to,</span>
<span class="sd">        firstly read what the data source is (JPL, CSR or ITSG)</span>
<span class="sd">        read file path for GRACE L2 spherical harmonics inputs,</span>
<span class="sd">        read replacement files for tn13 and tn14</span>
<span class="sd">        source of the SH files (JPL, ITSG or CSR)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#Created on Fri Feb  17 2023</span>
    <span class="c1">#@author: Amin Shakya, Interdisciplinary Center for Water Research (ICWaR), Indian Institute of Science (IISc)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This program supports working with GRACE L2 Spherical harmonics data from the following centers: CSR, JPL and ITSG&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Instructions to download data may be referred to in https://github.com/mn5hk/pyshbundle/blob/main/docs/index.md#how-to-download-data&quot;</span><span class="p">)</span>
    <span class="n">source</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter the source of L2 SH coeffs code(jpl, csr, gfz): &quot;</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">use_sample_files</span> <span class="o">==</span><span class="mi">1</span><span class="p">:</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You have chosen to use sample replacement files.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The replacement files for the TN13 and TN14 Args have been preloaded into the program&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Due to the size of the GRACE SH files, these have not been preloaded into the program&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You may download the GRACE SH L2 files from the link below. Please ensure to download the files as per your selection of source in the prior step&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Download sample files from: https://github.com/mn5hk/pyshbundle/tree/main/sample_input_data&quot;</span><span class="p">)</span>
    <span class="n">path_sh</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter the path to the folder with SH L2 data&quot;</span><span class="p">))</span>


    <span class="k">if</span> <span class="nb">str</span><span class="o">.</span><span class="n">upper</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;JPL&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">use_sample_files</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">path_tn13</span> <span class="o">=</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="s1">&#39;pyshbundle&#39;</span><span class="p">,</span> <span class="s1">&#39;data/sample_JPL_TN_files/TN-13_GEOC_JPL_RL06.txt&#39;</span><span class="p">)</span>
            <span class="n">path_tn14</span> <span class="o">=</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="s1">&#39;pyshbundle&#39;</span><span class="p">,</span> <span class="s1">&#39;data/sample_JPL_TN_files/TN-14_C30_C20_GSFC_SLR.txt&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Successfully loaded preloaded TN13 and TN14 replacement files for JPL&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path_tn13</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter the path to the file for tn13 replacement in .txt format&quot;</span><span class="p">))</span>
            <span class="n">path_tn14</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter the path to the file for tn14 replacement in .txt format&quot;</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Successfully loaded TN13 and TN14 replacement files for JPL&quot;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">str</span><span class="o">.</span><span class="n">upper</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;CSR&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">use_sample_files</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">path_tn13</span> <span class="o">=</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="s1">&#39;pyshbundle&#39;</span><span class="p">,</span> <span class="s1">&#39;data/sample_CSR_TN_files/TN-14_C30_C20_SLR_GSFC.txt&#39;</span><span class="p">)</span>
            <span class="n">path_tn14</span> <span class="o">=</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="s1">&#39;pyshbundle&#39;</span><span class="p">,</span> <span class="s1">&#39;data/sample_CSR_TN_files/TN-13_GEOC_CSR_RL06.1.txt&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Successfully loaded preloaded TN13 and TN14 replacement files for CSR&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path_tn13</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter the path to the file for tn13 replacement in .txt format&quot;</span><span class="p">))</span>
            <span class="n">path_tn14</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter the path to the file for tn14 replacement in .txt format&quot;</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Successfully loaded TN13 and TN14 replacement files for CSR&quot;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">str</span><span class="o">.</span><span class="n">upper</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;ITSG&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">use_sample_files</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">path_tn13</span> <span class="o">=</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="s1">&#39;pyshbundle&#39;</span><span class="p">,</span> <span class="s1">&#39;data/sample_ITSG_TN_files/TN-13_GEOC_CSR_RL06.1.txt&#39;</span><span class="p">)</span>
            <span class="n">path_tn14</span> <span class="o">=</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="s1">&#39;pyshbundle&#39;</span><span class="p">,</span> <span class="s1">&#39;data/sample_ITSG_TN_files/TN-14_C30_C20_SLR_GSFC.txt&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Successfully loaded preloaded TN13 and TN14 replacement files for ITSG&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path_tn13</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter the path to the file for tn13 replacement in .txt format&quot;</span><span class="p">))</span>
            <span class="n">path_tn14</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter the path to the file for tn14 replacement in .txt format&quot;</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Successfully loaded TN13 and TN14 replacement files for ITSG&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Source selection is incorrect. Please select between JPL, CSR or gfz&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">path_sh</span><span class="p">,</span> <span class="n">path_tn13</span><span class="p">,</span> <span class="n">path_tn14</span><span class="p">,</span> <span class="n">source</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="computing-ling-term-mean">Computing Ling Term Mean<a class="headerlink" href="#computing-ling-term-mean" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-function">



<a id="pyshbundle.io.load_longterm_mean"></a>
    <div class="doc doc-contents first">

        <p>Loads the long term mean values for the GRACE SH data</p>
<h3 id="pyshbundle.io.load_longterm_mean--parameters">Parameters<a class="headerlink" href="#pyshbundle.io.load_longterm_mean--parameters" title="Permanent link">&para;</a></h3>
<p>source (str, optional): 
    Source of data. Defaults to "".
use_sample_mean (int, optional)
    Whether to use default long-mean values provided with the data. Defaults to 0.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>Exception</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em></p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <h3 id="pyshbundle.io.load_longterm_mean--returns">Returns<a class="headerlink" href="#pyshbundle.io.load_longterm_mean--returns" title="Permanent link">&para;</a></h3>
<p>long_mean : str
    path of the appropriate long term mean file</p>


<details class="todo" open>
  <summary>Todo</summary>
  <ul>
<li>Not sure if using "source = ''" is all right</li>
<li>instead of base eception is can be ValueError</li>
</ul>
</details>
            <details class="quote">
              <summary>Source code in <code>pyshbundle/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_longterm_mean</span><span class="p">(</span><span class="n">source</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">use_sample_mean</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads the long term mean values for the GRACE SH data</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    source (str, optional): </span>
<span class="sd">        Source of data. Defaults to &quot;&quot;.</span>
<span class="sd">    use_sample_mean (int, optional)</span>
<span class="sd">        Whether to use default long-mean values provided with the data. Defaults to 0.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: _description_</span>

<span class="sd">    Returns</span>
<span class="sd">    ----------</span>
<span class="sd">    long_mean : str</span>
<span class="sd">        path of the appropriate long term mean file</span>

<span class="sd">    Todo:</span>
<span class="sd">        + Not sure if using &quot;source = &#39;&#39;&quot; is all right</span>
<span class="sd">        + instead of base eception is can be ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># @author: Amin Shakya, Interdisciplinary Center for Water Research (ICWaR), Indian Institute of Science (IISc)</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The purpose of this script is to,</span>
<span class="sd">        load longterm mean for our GRACE SH data</span>

<span class="sd">        For this, we need to input the GRACE data source as well as the path to the longterm mean values</span>
<span class="sd">        Data source may be CSR, JPL or ITSG.</span>

<span class="sd">        For RL06, example data have been provided within the package. In case this option is chosen, the program directly returns the longterm mean values.</span>

<span class="sd">        Returns the long_mean path</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">use_sample_mean</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading preloaded RL06 long term mean values&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please ensure that your data is RL06 </span><span class="se">\n</span><span class="s2">If not, please manually input long term mean by setting use_sample_mean = 0&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">str</span><span class="o">.</span><span class="n">upper</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;CSR&#39;</span><span class="p">:</span>
            <span class="n">long_mean</span> <span class="o">=</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="s1">&#39;pyshbundle&#39;</span><span class="p">,</span> <span class="s1">&#39;data/RL06_long_mean/SH_long_mean_csr.npy&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">str</span><span class="o">.</span><span class="n">upper</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;JPL&#39;</span><span class="p">:</span>
            <span class="n">long_mean</span> <span class="o">=</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="s1">&#39;pyshbundle&#39;</span><span class="p">,</span> <span class="s1">&#39;data/RL06_long_mean/SH_long_mean_itsg.npy&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">str</span><span class="o">.</span><span class="n">upper</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;ITSG&#39;</span><span class="p">:</span>
            <span class="n">long_mean</span> <span class="o">=</span> <span class="n">pkg_resources</span><span class="o">.</span><span class="n">resource_filename</span><span class="p">(</span><span class="s1">&#39;pyshbundle&#39;</span><span class="p">,</span> <span class="s1">&#39;data/RL06_long_mean/SH_long_mean_jpl.npy&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Incorrect selection of source&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Successfully loaded preloaded longterm means&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please download and provide the longterm GRACE SH mean values&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Instructions to download the longterm GRACE SH mean values may be referred to in https://github.com/mn5hk/pyshbundle/blob/main/docs/index.md#how-to-download-data&quot;</span><span class="p">)</span>
        <span class="n">long_mean</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter the longterm mean for the SH values in the numpy (.npy) format&quot;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Successfully loaded path to long term mean:&quot;</span><span class="p">,</span> <span class="n">long_mean</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">long_mean</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="physical-and-geodetic-constants">Physical and Geodetic Constants<a class="headerlink" href="#physical-and-geodetic-constants" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="pyshbundle.GRACEconstants"></a>
    <div class="doc doc-contents first">

        <p>This script contains some of the major relavant Physical and Geodetic(GRS80) constants:</p>
<ul>
<li><code>clight</code> speed of light - <span class="arithmatex">\(2.99792458e+8\)</span> <span class="arithmatex">\(m/s\)</span></li>
<li><code>G</code> Gravitational constant- <span class="arithmatex">\(6.67259e-11\)</span> $rac{m^3} {kg \cdot s^2}$</li>
<li>
<p><code>au</code> astronomical unit - <span class="arithmatex">\(149.597870691e+9\)</span> <span class="arithmatex">\(m\)</span></p>
</li>
<li>
<p><code>ae</code> semi-major axis of ellipsoid <code>GRS 80</code>- <span class="arithmatex">\(6378137\)</span> m</p>
</li>
<li><code>GM</code> geocentric grav. constant <code>GRS 80</code>- <span class="arithmatex">\(3.986005e+14\)</span> $rac{m^3}{s^2}$</li>
<li><code>J2</code> earth's dynamic form factor <code>GRS 80</code> - <span class="arithmatex">\(1.08263e-3\)</span> [unitless C20 unnormalized coefficient]</li>
<li>
<p><code>Omega</code> mean ang. velocity <code>GRS 80</code> - $7.292115e-5 $rac{rad}{s}$</p>
</li>
<li>
<p><code>flat</code> flattening - $rac{1}{298.257222101}$</p>
</li>
</ul>



  <div class="doc doc-children">











  </div>

    </div>

</div><h2 id="reference">Reference<a class="headerlink" href="#reference" title="Permanent link">&para;</a></h2>
<ul>
<li></li>
</ul>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    2024-09-06
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.56dfad97.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>